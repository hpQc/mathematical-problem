<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ•°å­¦é€‰æ‹©é¢˜ç”Ÿæˆå™¨</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      display: flex;
    }
    h1 {
      text-align: center;
    }

    button {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 16px;
    }

    #questions {
      max-width: 80%;
      margin: 0 auto;
    }

    form {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 10px;
    }

    #pageTitle {
      font-size: 1.5em; /* æ ¹æ®éœ€è¦è°ƒæ•´å­—ä½“å¤§å° */
    }

    .notification {
      /* å…¶ä»–æ ·å¼ */
      overflow-y: auto; /* æ·»åŠ æ»šåŠ¨æ¡ä»¥ä¾¿æŸ¥çœ‹æ‰€æœ‰å†…å®¹ */
    }
    .notification, #settings {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color: #fff;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid #ccc;
      z-index: 1000;
      cursor: move;
      overflow-y: auto; /* æ·»åŠ æ»šåŠ¨æ¡ä»¥ä¾¿æŸ¥çœ‹æ‰€æœ‰å†…å®¹ */
      -webkit-user-select: none;
      user-select: none;
    }

    .notification button, #settings button {
      display: block;
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }

    #sidebar {
      width: 0;
      height: 100%;
      background-color: #111;
      overflow-x: hidden;
      transition: 0.5s;
      padding-top: 60px;
      position: fixed;
      z-index: 1;
    }

    #sidebar a {
      padding: 8px 8px 8px 32px;
      text-decoration: none;
      font-size: 18px;
      color: #818181;
      display: block;
      transition: 0.3s;
    }

    #sidebar a:hover {
      color: #f1f1f1;
    }

    #main {
      width: 100%;
      transition: margin-left .5s;
      padding: 16px;
      margin-left: 0;
    }

    #sidebarToggle {
      display: block;
      position: fixed;
      left: 10px;
      top: 10px;
      cursor: pointer;
      z-index: 2;
      -webkit-user-select: none;
      user-select: none;
      width: 40px;
      height: 40px;
    }

    #sidebarToggle::before,
    #sidebarToggle::after,
    #sidebarToggle {
      content:'';
      position: absolute;
      height: 5px;
      width: 35px;
      background-color: #333 !important;
      transition: 0.4s;
    }

    #sidebarToggle::before {
      top: -10px;
    }

    #sidebarToggle::after {
      top: 10px;
    }

    #sidebarToggle:checked::before {
      transform: rotate(-45deg) translate(-9px, 6px);
    }

    #sidebarToggle:checked::after {
      transform: rotate(45deg) translate(-8px, -8px);
    }

    #sidebarToggle:checked {
      opacity: 1;
    }

    #sidebarToggle:checked + .bar:nth-child(1) {
      transform: rotate(-45deg) translate(-9px, 6px);
    }

    #sidebarToggle:checked + .bar:nth-child(2) {
      opacity: 0;
    }

    #sidebarToggle:checked + .bar:nth-child(3) {
      transform: rotate(45deg) translate(-8px, -8px);
    }

    #sidebarToggle:checked ~ #sidebar {
      width: 250px;
    }

    /* æ–°å¢çš„æ ·å¼ */
    #settings input, #settings select {
      margin-bottom: 10px;
    }

    #settings label {
      margin-bottom: 5px;
    }

    #scoreBoard {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color: #fff;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid #ccc;
      z-index: 1000;
      cursor: move;
      -webkit-user-select: none;
      user-select: none;
    }

    #scoreBoard button {
      display: block;
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    .translateSelectLanguage{
      position: absolute;
      width: 10em;
      top: 1em;
      right: 1em;
    }
    .historyNotificationsContainer {
      /* æ·»åŠ æ ·å¼ä»¥é™åˆ¶é«˜åº¦å’Œæ·»åŠ æ»šåŠ¨æ  */
      max-height: 150px;
      overflow-y: auto;
    }
    .historyNotification {
      /* æ ·å¼å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œè°ƒæ•´ */
      background-color: #ffeeba;
      padding: 10px;
      border: 1px solid #ffc107;
      margin-bottom: 10px;
    }
    /* æ–°å¢æ ·å¼ç”¨äºå…¨é»‘é¡µé¢é€šçŸ¥ */
    .blackPageNotification {
        z-index: 1500;
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgb(44, 44, 44);
        flex-direction: column;
        justify-content: center;
        align-items: center;
        cursor: default;
    }
    .blackPageNotificationContent {
        color: white;
        font-size: 20px;
    }
    canvas {
    /* border: 1px solid #838383; */
    position: relative;
    top: -20px;
    display: block;
    }
    #lizi {
    position: absolute;
    width: 100%;
    height: 100vh;
    }

    #lizi li {
        position: absolute;
        top: 105%;
        left: 0;
        width: 4px;
        height: 4px;
        background-color: rgb(253, 253, 253);
        border-radius: 50%;
        filter: blur(2px);
        list-style: none;

        animation: animate linear infinite;

    }
    @keyframes animate {
      0% {
          top: 100%;

      }

      100% {
          top: 0%;

      }
    }

    #decrition {
        position: relative;
        width: 300px;
        height: 5px;
        border-radius: 50%;
        filter: blur(1px);
        background-color: rgb(49, 49, 49);
        animation: animate2 3.5s linear infinite;
    }

    @keyframes animate2 {
        0% {
            background-color: rgb(49, 49, 49);

        }

        50% {
            background-color: rgb(119, 119, 119);
        }

        100% {
            background-color: rgb(49, 49, 49);

        }
    }
/* éšè—é¡µé¢ä¼ªå…ƒç´ é€šçŸ¥æ ·å¼ */
.hiddenPageNotification {
    z-index: 1500;
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    justify-content: center;
    align-items: center;
    cursor: pointer;
}

.hiddenPageNotificationContent {
    color: white;
    font-size: 20px;
}    
  </style>
</head>
<body>
  <input type="checkbox" id="sidebarToggle">
  <label for="sidebarToggle" class="bar" title="Toggle Sidebar"></label>
  <div id="sidebar">
    <a href="javascript:void(0);" onclick="showNotification()">å…¬å‘Š</a>
    <a href="javascript:void(0);" onclick="showSettings()">è®¾ç½®</a>
    <a href="#">è®¡åˆ†æ¿</a>  
  </div>
  <div id="scoreBoard" onmousedown="startDragScoreBoard(event)">
    <p id="scoreMessage">
      <!-- è®¡åˆ†æ¿å†…å®¹å°†åœ¨JavaScriptä¸­åŠ¨æ€æ·»åŠ  -->
    </p>
    <button onclick="closeScoreBoard()">å…³é—­</button>
    <div id="historyNotifications" class="historyNotificationsContainer"></div>
  </div>
  <div id="settings" class="notification" onmousedown="startDragSettings(event)">
    <!-- è®¾ç½®ä¸­å¿ƒå†…å®¹å°†åœ¨JavaScriptä¸­åŠ¨æ€æ·»åŠ  -->
  </div>
  <!-- éšè—é¡µé¢ä¼ªå…ƒç´ é€šçŸ¥ -->
  <div id="hiddenPageNotification" class="hiddenPageNotification">
    <div class="hiddenPageNotificationContent">
        ç‚¹å‡»å‰å¾€éšè—é¡µé¢
    </div>
  </div>
  <div id="blackPageNotification" class="blackPageNotification">
    <canvas width='500px' height='500px' id='content'>æ‚¨çš„æµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½ï¼Œè¯·å‡çº§æµè§ˆå™¨ï¼</canvas> <div id='decrition'></div><ul id='lizi'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>
  </div>
  <div id="main">
    <h1 id="pageTitle">æ•°å­¦é€‰æ‹©é¢˜</h1>
    <button id="generateButton" onclick="generateQuestionsButtonClick()">ç”Ÿæˆé¢˜ç›®</button>
    <div id="questions"></div>
    <button onclick="checkAnswers()">æ£€æŸ¥ç­”æ¡ˆ</button>
    <div class="notification" id="notification" onmousedown="startDrag(event)">
      <p>æ‹–åŠ¨æˆ‘ï¼</p>
      <button onclick="generateQuestions()">ç”Ÿæˆæ–°é¢˜ç›®</button>
      <button onclick="showCorrectAnswers()">è¯¦ç»†ç­”æ¡ˆ</button>
      <button onclick="closeNotification()">å…³é—­</button>
    </div>
  </div>

  <script>
    var questionsGenerated = false; // æ ‡å¿—æ˜¯å¦å·²ç”Ÿæˆé¢˜ç›®
    var score = 0; // ç”¨æˆ·å¾—åˆ†
    var notificationTimeout; // é€šçŸ¥å®šæ—¶å™¨
    var isDragging = false; // æ˜¯å¦æ­£åœ¨æ‹–åŠ¨é€šçŸ¥çª—å£
    var offsetX, offsetY; // æ‹–åŠ¨é€šçŸ¥çª—å£çš„åç§»é‡
    var isDraggingSettings = false; // æ˜¯å¦æ­£åœ¨æ‹–åŠ¨è®¾ç½®çª—å£
    var offsetXSettings, offsetYSettings; // æ‹–åŠ¨è®¾ç½®çª—å£çš„åç§»é‡
    var lastGeneratedSettings = { // ä¿å­˜ä¸Šæ¬¡ç”Ÿæˆçš„è®¾ç½®
      questionCount: 10,
      optionCount: 4,
      selectedOperators: ['+', '-', '*', '/']
    };
    // åˆå§‹åŒ–è®¡åˆ†æ¿ä¿¡æ¯
    var totalQuestions = 0;
    var correctAnswers = 0;
    var wrongAnswers = 0;
    var historyNotifications = []; // ä¿å­˜å†å²è®°å½•çš„æ•°ç»„
    var maxHistoryItems = 3; // æœ€å¤§å†å²è®°å½•æ•°
    var isDraggingScoreBoard = false;
    var offsetXScoreBoard, offsetYScoreBoard, initialXScoreBoard, initialYScoreBoard;

  
    // ç”Ÿæˆé¢˜ç›®çš„å‡½æ•°
    function generateQuestions(questionCount, optionCount, selectedOperators, minNumber, maxNumber, score) {
      // å°†å¾—åˆ†ä¼ é€’ç»™ç”Ÿæˆé¢˜ç›®çš„é€»è¾‘
      generateQuestionsLogic(questionCount, optionCount, selectedOperators, minNumber, maxNumber, score);
    }
    // ç”Ÿæˆé¢˜ç›®é€»è¾‘çš„è¾…åŠ©å‡½æ•°
    function generateQuestionsLogic(questionCount, optionCount, selectedOperators, minNumber, maxNumber, score) {
      var generateButton = document.getElementById("generateButton");
      generateButton.style.display = "none"; // éšè—ç”Ÿæˆé¢˜ç›®çš„æŒ‰é’®

      clearTimeout(notificationTimeout); // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨

      var feedbackContainer = document.getElementById("notification");
      feedbackContainer.style.display = "none"; // éšè—å¼¹çª—

      var questionsContainer = document.getElementById("questions");
      questionsContainer.innerHTML = ""; // æ¸…ç©ºä¹‹å‰çš„é¢˜ç›®

      for (var i = 0; i < questionCount; i++) {
        var num1 = Math.floor(Math.random() * (maxNumber - minNumber + 1)) + minNumber;
        var num2 = Math.floor(Math.random() * (maxNumber - minNumber + 1)) + minNumber;
        var operator = selectedOperators[Math.floor(Math.random() * selectedOperators.length)];
        var answer;

      // è®¡ç®—ç­”æ¡ˆä¹‹å‰æ£€æŸ¥è¿ç®—ç¬¦
      switch (operator) {
        case "+":
          answer = num1 + num2;
          break;
        case "-":
          answer = num1 - num2;
          break;
        case "*":
          answer = num1 * num2;
          break;
        case "/":
          // ç¡®ä¿åˆ†æ¯ä¸ä¸ºé›¶
          if (num2 !== 0) {
            answer = num1 / num2;
          } else {
            // å¦‚æœåˆ†æ¯ä¸ºé›¶ï¼Œåˆ™é‡æ–°ç”Ÿæˆ num2
            num2 = Math.floor(Math.random() * (maxNumber - minNumber + 1)) + minNumber;
            answer = num1 / num2;
          }
          break;
        default:
          // å¤„ç†æœªçŸ¥è¿ç®—ç¬¦ï¼Œè¿™é‡Œæ‚¨å¯ä»¥è¿›è¡Œé€‚å½“çš„å¤„ç†
          alert("æœªçŸ¥çš„è¿ç®—ç¬¦ï¼š" + operator);
          return;
      }

      // ... ä¹‹å‰çš„ç”Ÿæˆé¢˜ç›®é€»è¾‘ ...

      var options = generateOptions(answer, i, optionCount);

      var question = num1 + " " + operator + " " + num2 + " = ?";
      var questionHTML = "<p>" + question + "</p><form data-answer='" + answer + "'>" + options + "</form>";

      questionsContainer.innerHTML += questionHTML;
  }

  questionsGenerated = true;
  // score = 0;

  // ä¿å­˜å½“å‰ç”Ÿæˆçš„è®¾ç½®
  lastGeneratedSettings = {
    questionCount: questionCount,
    optionCount: optionCount,
    selectedOperators: selectedOperators,
    minNumber: minNumber,
    maxNumber: maxNumber
  };
  var feedbackMessage = "<p>ç­”é¢˜å®Œæˆï¼å¾—åˆ†: " + score + "</p>";
  // åŠ¨æ€æ”¹å˜æ ‡é¢˜
  applyTitleSettings(generateTitleFromSettings(lastGeneratedSettings));
}
        
    // ç”Ÿæˆæ ‡é¢˜çš„å‡½æ•°ï¼Œæ ¹æ®è®¾ç½®è¿”å›ç›¸åº”æ ‡é¢˜
    function generateTitleFromSettings(settings) {
      var title = settings.minNumber + " ~ " + settings.maxNumber + "çš„";

      // æ ¹æ®è¿ç®—ç¬¦å·ç®€ç§°æ·»åŠ é¢å¤–ä¿¡æ¯
      if (settings.selectedOperators.includes('+')) {
        title += "åŠ ";
      }
      if (settings.selectedOperators.includes('-')) {
        title += "å‡";
      }
      if (settings.selectedOperators.includes('*')) {
        title += "ä¹˜";
      }
      if (settings.selectedOperators.includes('/')) {
        title += "é™¤";
      }

      title += "é€‰æ‹©é¢˜";

      return title;

    
    }

    // åœ¨ç”Ÿæˆé¢˜ç›®æ—¶è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå°†è®¾ç½®çš„æ ‡é¢˜åº”ç”¨åˆ°é¡µé¢ä¸Š
    function applyTitleSettings(title) {
      var pageTitle = document.getElementById("pageTitle");
      pageTitle.textContent = title;
      // åœ¨ç”Ÿæˆè¯¦ç»†ç­”æ¡ˆé¡µé¢æˆ–æ›´æ”¹æ ‡é¢˜åï¼Œæ‰‹åŠ¨è°ƒç”¨ç¿»è¯‘
      translate.execute();
    }

    // ç”Ÿæˆæ–°é¢˜ç›®çš„å‡½æ•°ï¼Œä½¿ç”¨ä¸Šæ¬¡ç”Ÿæˆçš„è®¾ç½®
    function generateNewQuestions() {
      generateQuestions(lastGeneratedSettings.questionCount, lastGeneratedSettings.optionCount, lastGeneratedSettings.selectedOperators, lastGeneratedSettings.minNumber, lastGeneratedSettings.maxNumber, score);
      // æ›´æ–°è®¡åˆ†æ¿ä¿¡æ¯
      updateScoreMessage();
      window.scrollTo({
                top: 0,
                behavior: 'smooth'  // ä½¿ç”¨å¹³æ»‘æ»šåŠ¨æ•ˆæœ
            });
    }


    // æ˜¾ç¤ºä¸‹ä¸€é¢˜ç­”æ¡ˆçš„å‡½æ•°
    function showNextAnswer() {
    var feedbackContainer = document.getElementById("notification");
    feedbackContainer.innerHTML = "<p>é¢˜ç›®çš„æ­£ç¡®ç­”æ¡ˆï¼š</p>";

    var questions = document.querySelectorAll("#questions form");
    for (var i = 0; questions && i < questions.length; i++) {
      var correctAnswer = questions[i].getAttribute("data-answer");
      feedbackContainer.innerHTML += "<p>ç¬¬ " + (i + 1) + " é¢˜çš„æ­£ç¡®ç­”æ¡ˆæ˜¯ " + correctAnswer + "ã€‚</p>";
    }

    // æ·»åŠ ç”Ÿæˆæ–°é¢˜ç›®æŒ‰é’®
    feedbackContainer.innerHTML += "<button onclick='generateNewQuestions()'>ç”Ÿæˆæ–°é¢˜ç›®</button>";

    feedbackContainer.style.display = "block";
  }

    // æ–°å‡½æ•°ï¼Œç”¨äºè°ƒç”¨ generateQuestions å¹¶ä¼ é€’å‚æ•°
    function generateQuestionsButtonClick() {
      generateQuestions(10, 4, ['+', '-', '*', '/'], 1, 20, score); // ä¼ é€’æ­£ç¡®çš„å‚æ•°ï¼ŒåŒ…æ‹¬ minNumber å’Œ maxNumber
    }

  
    // åº”ç”¨è®¾ç½®çš„å‡½æ•°
    function applySettings() {
      var questionCountInput = document.getElementById("questionCount");
      var optionCountInput = document.getElementById("optionCount");
      var minNumberInput = document.getElementById("minNumber"); // æ–°å¢è·å–æœ€å°æ•°å­—çš„è¾“å…¥æ¡†
      var maxNumberInput = document.getElementById("maxNumber"); // æ–°å¢è·å–æœ€å¤§æ•°å­—çš„è¾“å…¥æ¡†
      var questionCount = parseInt(questionCountInput.value);
      var optionCount = parseInt(optionCountInput.value);
      var minNumber = parseInt(minNumberInput.value); // è·å–æœ€å°æ•°å­—
      var maxNumber = parseInt(maxNumberInput.value); // è·å–æœ€å¤§æ•°å­—
  
      if (isNaN(questionCount) || isNaN(optionCount) || questionCount < 1 || optionCount < 2) {
        alert("è¯·æ­£ç¡®å¡«å†™è®¾ç½®ä¸­çš„æ•°å­—ã€‚");
        return;
      }
  
      // è·å–å¤é€‰æ¡†çš„çŠ¶æ€
      var additionSelected = document.getElementById('additionCheckbox').checked;
      var subtractionSelected = document.getElementById('subtractionCheckbox').checked;
      var multiplicationSelected = document.getElementById('multiplicationCheckbox').checked;
      var divisionSelected = document.getElementById('divisionCheckbox').checked;
  
      // æ ¹æ®å¤é€‰æ¡†çŠ¶æ€æ„å»ºè¿ç®—ç¬¦æ•°ç»„
      var selectedOperators = [];
      if (additionSelected) selectedOperators.push('+');
      if (subtractionSelected) selectedOperators.push('-');
      if (multiplicationSelected) selectedOperators.push('*');
      if (divisionSelected) selectedOperators.push('/');
  
      if (selectedOperators.length === 0) selectedOperators = ['+'];
  
      // ä¼ é€’æœ€å°å’Œæœ€å¤§æ•°å­—å‚æ•°
      generateQuestions(questionCount, optionCount, selectedOperators, minNumber, maxNumber);

      closeSettings(); // å…³é—­è®¾ç½®ä¸­å¿ƒ

      applyTitleSettings(generateTitleFromSettings({
        questionCount: questionCount,
        optionCount: optionCount,
        selectedOperators: selectedOperators,
        minNumber: minNumber,
        maxNumber: maxNumber
      }));
    }
  
    // è®¡ç®—ç­”æ¡ˆçš„å‡½æ•°
    function calculateAnswer(num1, num2, operator) {
      switch (operator) {
        case "+":
          return num1 + num2;
        case "-":
          return num1 - num2;
        case "*":
          return num1 * num2;
        case "/":
          return num1 / num2;
      }
    }
  
    // ç”Ÿæˆé€‰é¡¹çš„å‡½æ•°
    function generateOptions(answer, questionIndex, optionCount) {
      var options = [answer];
      while (options.length < optionCount) {
        var randomOption = Math.floor(Math.random() * 40) + 1;
        if (!options.includes(randomOption)) {
          options.push(randomOption);
        }
      }
      options.sort(function (a, b) {
        return 0.5 - Math.random()
      });
      var optionsHTML = "";
      for (var i = 0; i < options.length; i++) {
        optionsHTML += "<label><input type='radio' name='q" + questionIndex + "' value='" + options[i] + "'>" + options[i] + "</label>";
      }
      return optionsHTML;
    }
  
// æ£€æŸ¥ç­”æ¡ˆçš„å‡½æ•°
function checkAnswers() {
  if (!questionsGenerated) {
    alert("è¯·å…ˆç”Ÿæˆé¢˜ç›®ã€‚");
    return;
  }

  var feedbackContainer = document.getElementById("notification");
  feedbackContainer.innerHTML = ""; // æ¸…ç©ºä¹‹å‰çš„åé¦ˆä¿¡æ¯

  var questions = document.querySelectorAll("#questions form");
  var allAnswered = true;

  for (var i = 0; i < questions.length; i++) {
    var selectedOption = questions[i].querySelector("input[type='radio']:checked");
    var correctAnswer = questions[i].getAttribute("data-answer");

    if (!selectedOption) {
      allAnswered = false;
      displayNotification("è¯·å›ç­”æ‰€æœ‰é¢˜ç›®ã€‚");
      break;
    } else {
      // è°ƒç”¨è®°å½•ç­”æ¡ˆçš„å‡½æ•°
      recordAnswer(selectedOption.value, correctAnswer);
    }
  }

  if (allAnswered) {
    var feedbackMessage = "<p>ç­”é¢˜å®Œæˆï¼å¾—åˆ†: " + score + "</p>";
    feedbackMessage += "<button onclick='generateNewQuestions()'>ç”Ÿæˆæ–°é¢˜ç›®</button>";
    feedbackMessage += "<button onclick='showCorrectAnswers()'>è¯¦ç»†ç­”æ¡ˆ</button>";

    feedbackContainer.innerHTML = feedbackMessage;
    feedbackContainer.style.display = "block";
    questionsGenerated = false; // å…è®¸é‡æ–°ç”Ÿæˆé¢˜ç›®

    // æ›´æ–°è®¡åˆ†æ¿ä¿¡æ¯
    updateScoreMessage();
  }
}
    // æ˜¾ç¤ºé€šçŸ¥çš„å‡½æ•°
    function displayNotification(message) {
      var feedbackContainer = document.getElementById("notification");
      feedbackContainer.innerHTML = "<p>" + message + "</p>";
      feedbackContainer.style.display = "block";
      notificationTimeout = setTimeout(function () {
        feedbackContainer.style.display = "none";
      }, 3000); // 3ç§’åéšè—å¼¹çª—
    }
  
    // æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆçš„å‡½æ•°
    function showCorrectAnswers() {
      var feedbackContainer = document.getElementById("notification");
      feedbackContainer.innerHTML = "<p>é¢˜ç›®çš„æ­£ç¡®ç­”æ¡ˆï¼š</p>";

      var questions = document.querySelectorAll("#questions form");
      for (var i = 0; questions && i < questions.length; i++) {
        var correctAnswer = questions[i].getAttribute("data-answer");
        feedbackContainer.innerHTML += "<p>ç¬¬ " + (i + 1) + " é¢˜çš„æ­£ç¡®ç­”æ¡ˆæ˜¯ " + correctAnswer + "ã€‚</p>";
      }

      // è®¾ç½®é€šçŸ¥çª—å£çš„æœ€å¤§é«˜åº¦
      feedbackContainer.style.maxHeight = "80vh";
      // æ·»åŠ ç”Ÿæˆæ–°é¢˜ç›®æŒ‰é’®
      feedbackContainer.innerHTML += "<button onclick='generateNewQuestions()'>ç”Ÿæˆæ–°é¢˜ç›®</button>";

      feedbackContainer.style.display = "block";
      // åœ¨ç”Ÿæˆè¯¦ç»†ç­”æ¡ˆé¡µé¢æˆ–æ›´æ”¹æ ‡é¢˜åï¼Œæ‰‹åŠ¨è°ƒç”¨ç¿»è¯‘
      translate.execute();
 
    }
  
// æ‹–åŠ¨é€šçŸ¥çª—å£çš„å‡½æ•°
function startDrag(event) {
    isDragging = true;
    offsetX = event.clientX - parseInt(document.getElementById("notification").style.left) || 0;
    offsetY = event.clientY - parseInt(document.getElementById("notification").style.top) || 0;
    document.addEventListener("mousemove", drag);
    document.addEventListener("mouseup", stopDrag);
}

function drag(event) {
    if (isDragging) {
        var newX = event.clientX - offsetX;
        var newY = event.clientY - offsetY;

        // é™åˆ¶é€šçŸ¥çª—å£ä¸è¶…å‡ºæµè§ˆå™¨è¾¹ç•Œ
        newX = Math.max(80, Math.min(window.innerWidth + 80 - document.getElementById("notification").offsetWidth, newX));
        newY = Math.max(100, Math.min(window.innerHeight + 100 - document.getElementById("notification").offsetHeight, newY));

        document.getElementById("notification").style.left = newX + "px";
        document.getElementById("notification").style.top = newY + "px";
    }
}

function stopDrag() {
    isDragging = false;
    document.removeEventListener("mousemove", drag);
    document.removeEventListener("mouseup", stopDrag);
}

  
    // æ˜¾ç¤ºé€šçŸ¥çš„å‡½æ•°
    function showNotification() {
      var notificationContainer = document.getElementById("notification");
      notificationContainer.innerHTML = "<p>ä»£ç ç”± GPT-3.5 ç”Ÿæˆ</p><a target='_blank' href='https://github.com/xnx3/translate's style='color: #000000; text-decoration: none;'>ç¿»è¯‘ï¼š<spen class='ignore'>translate.js</spen></a><br><a target='_blank' href='https://darkmodejs.learn.uno/?ref=appinn' style='color: #000000; text-decoration: none;'>å¤œé—´æ¨¡å¼</a><br><a target='_blank' href='https://github.com/sorrowings/myCodes/tree/main/webCode/exercise' style='color: #000000; text-decoration: none;'>ç²’å­ç‰¹æ•ˆ</a><a target='_blank' href='https://space.bilibili.com/386484683' style='color: #000000; text-decoration: none;'>ä½œè€…ï¼š<spen class='ignore'>sorrowings</spen></a><br><a target='_blank' href='https://space.bilibili.com/1993149101' style='color: #000000; text-decoration: none;'>ä½œè€…ï¼š<spen class='ignore'>æ°µäº†é¸­</spen></a><button onclick='closeNotification()'>å…³é—­</button>";
      notificationContainer.style.display = "block";
    }
  
    // å…³é—­é€šçŸ¥çš„å‡½æ•°
    function closeNotification() {
      var notificationContainer = document.getElementById("notification");
      notificationContainer.style.display = "none";
    }
  
    // å…³é—­è®¾ç½®ä¸­å¿ƒçš„å‡½æ•°
    function closeSettings() {
      var settingsContainer = document.getElementById("settings");
      settingsContainer.style.display = "none";
    }

// å¼€å§‹æ‹–åŠ¨è®¾ç½®çª—å£çš„å‡½æ•°
function startDragSettings(event) {
    isDraggingSettings = true;

    // è®°å½•é¼ æ ‡ç‚¹å‡»çš„ä½ç½®ç›¸å¯¹äºè®¾ç½®çª—å£çš„åç§»
    offsetXSettings = event.clientX - document.getElementById("settings").getBoundingClientRect().left;
    offsetYSettings = event.clientY - document.getElementById("settings").getBoundingClientRect().top;

    document.addEventListener("mousemove", dragSettings);
    document.addEventListener("mouseup", stopDragSettings);
}

// æ‹–åŠ¨è®¾ç½®çª—å£çš„å‡½æ•°
function dragSettings(event) {
    if (isDraggingSettings) {
        // è®¡ç®—æ–°çš„è®¾ç½®çª—å£ä½ç½®
        var newXSettings = event.clientX - offsetXSettings;
        var newYSettings = event.clientY - offsetYSettings;

        // é™åˆ¶è®¾ç½®çª—å£ä¸è¶…å‡ºæµè§ˆå™¨è¾¹ç•Œ
        newXSettings = Math.max(80, Math.min(window.innerWidth + 80 - document.getElementById("settings").offsetWidth, newXSettings));
        newYSettings = Math.max(300, Math.min(window.innerHeight + 1000 - document.getElementById("settings").offsetHeight, newYSettings));

        // è®¡ç®—æ–°çš„è®¾ç½®çª—å£é«˜åº¦å¹¶é™åˆ¶ä¸è¶…è¿‡æµè§ˆå™¨é«˜åº¦
        var newHeight = window.innerHeight - newYSettings;
        newHeight = Math.max(0, Math.min(window.innerHeight, newHeight));
        // è®¾ç½®æ–°çš„ä½ç½®å’Œé«˜åº¦
        document.getElementById("settings").style.left = newXSettings + "px";
        document.getElementById("settings").style.top = window.innerHeight - newHeight + "px";
        document.getElementById("settings").style.height = newHeight + "px";
    }
}

// åœæ­¢æ‹–åŠ¨è®¾ç½®çª—å£çš„å‡½æ•°
function stopDragSettings() {
    isDraggingSettings = false;
    document.removeEventListener("mousemove", dragSettings);
    document.removeEventListener("mouseup", stopDragSettings);
}

// åœ¨è®¾ç½®çª—å£ä¸Šæ·»åŠ mousedownäº‹ä»¶ç›‘å¬å™¨
document.getElementById("settings").addEventListener("mousedown", startDragSettings);

  
// æ˜¾ç¤ºè®¾ç½®ä¸­å¿ƒçš„å‡½æ•°
    function showSettings() {
      var settingsContainer = document.getElementById("settings");
      settingsContainer.innerHTML = "<p>è®¾ç½®ä¸­å¿ƒå†…å®¹</p>" +
        "<label for='questionCount'>é¢˜ç›®æ•°é‡:</label>" +
        "<input type='number' id='questionCount' min='1' max='20' value='10'>" +
        "<label for='optionCount'>é€‰æ‹©é¢˜é€‰é¡¹ä¸ªæ•°:</label>" +
        "<input type='number' id='optionCount' min='2' max='6' value='4'>" +
        "<label for='minNumber'>æœ€å°æ•°å­—:</label>" +
        "<input type='number' id='minNumber' min='-10000' max='10000' value='1'>" +
        "<label for='maxNumber'>æœ€å¤§æ•°å­—:</label>" +
        "<input type='number' id='maxNumber' min='-10000' max='10000' value='20'>" +
        "<label>è¿ç®—ç¬¦å·:</label>" +
        "<label for='additionCheckbox'><input type='checkbox' id='additionCheckbox' checked>åŠ æ³•</label>" +
        "<label for='multiplicationCheckbox'><input type='checkbox' id='multiplicationCheckbox' checked>ä¹˜æ³•</label>" +
        "<label for='subtractionCheckbox'><input type='checkbox' id='subtractionCheckbox' checked>å‡æ³•</label>" +
        "<label for='divisionCheckbox'><input type='checkbox' id='divisionCheckbox' checked>é™¤æ³•</label>" +
        "<button onclick='applySettings()'>åº”ç”¨è®¾ç½®</button>" +
        "<button onclick='closeSettings()'>å…³é—­</button>";
      settingsContainer.style.display = "block";
    }

    // è®°å½•ç”¨æˆ·é€‰æ‹©çš„ç­”æ¡ˆ
    function recordAnswer(selectedValue, correctAnswer) {
      totalQuestions++;
      if (selectedValue == correctAnswer) {
        correctAnswers++;
        // åœ¨è¿™é‡Œç´¯ç§¯å¾—åˆ†
        score++; // æˆ–æ ¹æ®æ‚¨çš„å¾—åˆ†è§„åˆ™è¿›è¡Œç´¯ç§¯
      } else {
        wrongAnswers++;
      }
    }    
    // è®¡åˆ†æ¿ç‚¹å‡»æ—¶è°ƒç”¨ showScoreBoard() å‡½æ•°
    document.querySelector("#sidebar a:nth-child(3)").addEventListener("click", function () {
      showScoreBoard();
    });
    // æ˜¾ç¤ºè®¡åˆ†æ¿çš„å‡½æ•°
    function showScoreBoard() {
      var scoreBoard = document.getElementById("scoreBoard");
      scoreBoard.style.display = "block";
      updateScoreMessage();
    }
    // å…³é—­è®¡åˆ†æ¿çš„å‡½æ•°
    function closeScoreBoard() {
      var scoreBoard = document.getElementById("scoreBoard");
      scoreBoard.style.display = "none";
    }

    // æ›´æ–°è®¡åˆ†æ¿ä¿¡æ¯çš„å‡½æ•°
    function updateScoreMessage() {
      var scoreMessage = document.getElementById("scoreMessage");
      scoreMessage.innerHTML = "æ€»é¢˜æ•°ï¼š" + totalQuestions +
                                "<br>å¾—åˆ†: " + score +
                                "<br>æ­£ç¡®æ¬¡æ•°ï¼š" + correctAnswers +
                                "<br>é”™è¯¯æ¬¡æ•°ï¼š" + wrongAnswers;

      // å½“æ€»é¢˜æ•°è¾¾åˆ°100æ—¶ï¼Œä¿å­˜å†å²è®°å½•
      if (totalQuestions % 100 === 0 && totalQuestions > 0) {
        saveHistory();
        showHistoryNotification();
        resetStatistics();
      }

    }
    // å¼€å§‹æ‹–åŠ¨è®¡åˆ†æ¿çª—å£çš„å‡½æ•°
    function startDragScoreBoard(event) {
        isDraggingScoreBoard = true;

        // è®°å½•é¼ æ ‡åœ¨çª—å£å†…çš„åˆå§‹ä½ç½®å’Œçª—å£çš„åˆå§‹ä½ç½®
        initialXScoreBoard = document.getElementById("scoreBoard").getBoundingClientRect().left;
        initialYScoreBoard = document.getElementById("scoreBoard").getBoundingClientRect().top;
        offsetXScoreBoard = event.clientX - initialXScoreBoard;
        offsetYScoreBoard = event.clientY - initialYScoreBoard;

        document.addEventListener("mousemove", dragScoreBoard);
        document.addEventListener("mouseup", stopDragScoreBoard);
    }

    // æ‹–åŠ¨è®¡åˆ†æ¿çª—å£çš„å‡½æ•°
    function dragScoreBoard(event) {
        if (isDraggingScoreBoard) {
            var newXScoreBoard = event.clientX - offsetXScoreBoard;
            var newYScoreBoard = event.clientY - offsetYScoreBoard;

            // é™åˆ¶è®¡åˆ†æ¿çª—å£ä¸è¶…å‡ºæµè§ˆå™¨è¾¹ç•Œ
            newXScoreBoard = Math.max(0, Math.min(window.innerWidth - document.getElementById("scoreBoard").offsetWidth, newXScoreBoard));
            newYScoreBoard = Math.max(0, Math.min(window.innerHeight - document.getElementById("scoreBoard").offsetHeight, newYScoreBoard));

            // è®¾ç½®æ–°çš„ä½ç½®
            document.getElementById("scoreBoard").style.left = newXScoreBoard + "px";
            document.getElementById("scoreBoard").style.top = newYScoreBoard + "px";
        }
    }

    // åœæ­¢æ‹–åŠ¨è®¡åˆ†æ¿çª—å£çš„å‡½æ•°
    function stopDragScoreBoard() {
        isDraggingScoreBoard = false;
        document.removeEventListener("mousemove", dragScoreBoard);
        document.removeEventListener("mouseup", stopDragScoreBoard);
    }
        // ä¿å­˜å†å²è®°å½•çš„å‡½æ•°
    function saveHistory() {
      var historyItem = {
        totalQuestions: totalQuestions,
        score: score,
        correctAnswers: correctAnswers,
        wrongAnswers: wrongAnswers
      };
      historyNotifications.push(historyItem);
    }

     // æ˜¾ç¤ºå†å²è®°å½•é€šçŸ¥çš„å‡½æ•°
     function showHistoryNotification() {
      var historyNotificationsContainer = document.getElementById("historyNotifications");
      var historyItem = historyNotifications[historyNotifications.length - 1];
      // å¦‚æœæ€»é¢˜æ•°å’Œæ­£ç¡®æ¬¡æ•°éƒ½ä¸º0ï¼Œåˆ™ä¸æ˜¾ç¤ºé€šçŸ¥
      if (historyItem.totalQuestions === 0 && historyItem.correctAnswers === 0) {
        return;
      }
      // å¦‚æœå†å²è®°å½•æ•°é‡è¶…è¿‡æœ€å¤§å€¼ï¼Œç§»é™¤æœ€æ—§çš„ä¸€æ¡è®°å½•
      if (historyNotifications.length > maxHistoryItems) {
        historyNotificationsContainer.removeChild(historyNotificationsContainer.firstChild);
      }

      var historyNotification = document.createElement("div");
      historyNotification.className = "historyNotification";
      historyNotification.innerHTML = "<p>å†å²è®°å½•<br>æ€»é¢˜æ•°ï¼š" + historyItem.totalQuestions +
                                       "<br>å¾—åˆ†: " + historyItem.score +
                                       "<br>æ­£ç¡®æ¬¡æ•°ï¼š" + historyItem.correctAnswers +
                                       "<br>é”™è¯¯æ¬¡æ•°ï¼š" + historyItem.wrongAnswers +
                                       "</p>";
      // åˆ¤æ–­æ€»é¢˜æ•°å’Œæ­£ç¡®æ¬¡æ•°æ˜¯å¦ç›¸ç­‰
      if (historyItem.totalQuestions === historyItem.correctAnswers) {
        openBlackPageNotification(); // æ‰“å¼€å…¨é»‘é¡µé¢é€šçŸ¥
      }
      historyNotificationsContainer.appendChild(historyNotification);

      // æ»šåŠ¨åˆ°åº•éƒ¨ä»¥æ˜¾ç¤ºæœ€æ–°çš„å†å²è®°å½•
      historyNotificationsContainer.scrollTop = historyNotificationsContainer.scrollHeight;
    }

    // é‡ç½®ç»Ÿè®¡ä¿¡æ¯çš„å‡½æ•°
    function resetStatistics() {
      totalQuestions = 0;
      score = 0;
      correctAnswers = 0;
      wrongAnswers = 0;
    }
// æ‰“å¼€å…¨é»‘é¡µé¢é€šçŸ¥çš„å‡½æ•°
function openBlackPageNotification() {
    var blackPageNotification = document.getElementById("blackPageNotification");
    var hiddenPageNotification = document.getElementById("hiddenPageNotification");

    // å¦‚æœæ€»é¢˜æ•°å’Œæ­£ç¡®æ¬¡æ•°éƒ½ä¸º0ï¼Œåˆ™ä¸æ˜¾ç¤ºå…¨é»‘é¡µé¢é€šçŸ¥
    if (score === 0 && correctAnswers === 0) {
        return;
    }else{
      // æ˜¾ç¤ºéšè—é¡µé¢ä¼ªå…ƒç´ é€šçŸ¥
      hiddenPageNotification.style.display = "flex";
    }

    
    
    // ç‚¹å‡»éšè—é¡µé¢ä¼ªå…ƒç´ é€šçŸ¥åï¼Œæ˜¾ç¤ºå…¨é»‘é¡µé¢é€šçŸ¥
    hiddenPageNotification.addEventListener("click", function () {    
        hiddenPageNotification.style.display = "none";
        blackPageNotification.style.display = "flex";
    });
    
    // è®¾ç½®é€šçŸ¥çš„æŒç»­æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰
    var notificationDuration = 45000; // 45ç§’

    // åœ¨ä¸€å®šæ—¶é—´åå…³é—­é€šçŸ¥
    setTimeout(function () {
        hiddenPageNotification.style.display = "none";
        blackPageNotification.style.display = "none";
    }, notificationDuration);
}

  </script>
<script type="module">
  window.onload = function () {
      // è·å–ç”»å¸ƒ
      var canvas = document.querySelector("#content");
      var context = canvas.getContext("2d");

      // å°è£…å‡½æ•°å·¥å…·
      // ç”»ç‚¹
      function drawCircle(x, y, r, color) {
          context.beginPath();
          context.fillStyle = color;
          context.arc(x, y, r, Math.PI / 180 * 0, Math.PI / 180 * 360);
          context.fill();
      }

      // ç”»ç²’å­çš„å›¾åƒå’Œæ–¹æ³•
      class ball {
          constructor(dx, dy) {
              this.x = range(w);
              this.y = range(h);
              this.dx = dx;
              this.dy = dy;
              this.initialX = this.dx - this.x;
              this.initialY = this.dy - this.y;
              this.time = 100;
              this.r = 1.5;
              this.color = colorR();
          }

          draw(count) {
              this.x += this.initialX * 2 / this.time * (1 - count / this.time);
              this.y += this.initialY * 2 / this.time * (1 - count / this.time);
              drawCircle(this.x, this.y, this.r, this.color);
          }
      }

      // ç”Ÿæˆéšæœºæ•°
      function range(i) {
          return Math.random() * i;
      }

      function intR(i) {
          return Math.floor(Math.random() * i);
      }

      // éšæœºé¢œè‰²
      function colorR() {
          let key = range(1);
          if (key > 0.3) {
              return '#fff';
          } else return '#838383';
      }

      // ç­›é€‰ç²’å­ä½ç½®
      function getImgData(img) {
          context.clearRect(0, 0, w, h);
          context.drawImage(img, 0, 0, w, h);
          context.imageSmoothingEnabled = true;
          context.imageSmoothingQuality = 'high';
          var copy = context.getImageData(0, 0, w, h);
          img.ballArr = [];
          context.clearRect(0, 0, w, h);
          for (var y = 0; y < h; y += 8) {
              for (var x = 0; x < w; x += 8) {
                  var index = x + y * w;
                  var a = copy.data[index * 4 + 3];
                  if (a > 100) {
                      let bal = new ball(x, y);
                      img.ballArr.push(bal);
                  }
              }
          }
      }

      // è®¾ç½®åŠ¨ç”»
      function animateBall(img) {
          var count = 1;
          clearInterval(t1);
          t1 = setInterval(function () {
              context.clearRect(0, 0, w, h);
              for (var i = 0; i < img.ballArr.length; i++) {
                  img.ballArr[i].draw(count);
              }
              if (count == 100) {
                  clearInterval(t1);
              }
              count++;
          }, 30);
      }

      // å¼€å§‹åŠ¨ç”»
      function start(a, b, t) {
          setTimeout(() => {
              relateTow(a, b);
              animateBall(a);
          }, 7500 * t);
      }

      //è¿æ¥ä¸¤ä¸ªæ•°ç»„
      function relateTow(a, b) {
          for (let i = 0; i < a.ballArr.length; i++) {
              let v = intR(b.ballArr.length);
              a.ballArr[i].x = b.ballArr[v].dx;
              a.ballArr[i].initialX = a.ballArr[i].dx - a.ballArr[i].x;
              a.ballArr[i].y = b.ballArr[v].dy;
              a.ballArr[i].initialY = a.ballArr[i].dy - a.ballArr[i].y;
          }
      }

      // è·å–æ‰€æœ‰çš„å›¾å½¢ï¼Œç²’å­ä½ç½®ä¿¡æ¯
      var img1 = new Image();
      var img2 = new Image();

      img1.src = './image/åŠ æ²¹.png';
      img2.src = './image/æ°µäº†é¸­_ba-style@nulla.top.png';

      var t1; //å®šæ—¶å™¨

      // åˆå§‹ç”»å¸ƒå®½é«˜
      var w = 500;
      var h = 500;
      canvas.width = w;
      canvas.height = h;

      window.addEventListener('resize', function () {
          // å½“å±å¹•å®½åº¦å°äº500pxæ—¶ï¼Œä»¥å±å¹•å®½åº¦ä¸ºå‡†
          if (window.innerWidth < 500) {
              w = window.innerWidth;
              h = window.innerWidth;
          } else {
              w = 500;
              h = 500;
          }
          canvas.width = w;
          canvas.height = h;
          getImgData(img1);
          getImgData(img2);
      });

      img1.onload = function () {
          getImgData(img1);
      };

      img2.onload = function () {
          getImgData(img2);
      };

      setTimeout(() => {
          const target = () => {
              start(img1, img2, 0);
              start(img2, img1, 1);
              return target;
          };
          setInterval(target(), 15000);
      }, 100);
  };
</script>

  <script src="https://cdn.jsdelivr.net/gh/xnx3/translate@latest/translate.js/translate.min.js"></script>
  <script>
    translate.setUseVersion2(); //è®¾ç½®ä½¿ç”¨v2.x ç‰ˆæœ¬
    translate.listener.start();    //å¼€å¯htmlé¡µé¢å˜åŒ–çš„ç›‘æ§ï¼Œå¯¹å˜åŒ–éƒ¨åˆ†ä¼šè¿›è¡Œè‡ªåŠ¨ç¿»è¯‘ã€‚æ³¨æ„ï¼Œè¿™é‡Œå˜åŒ–åŒºåŸŸï¼Œæ˜¯æŒ‡ä½¿ç”¨ translate.setDocuments(...) è®¾ç½®çš„åŒºåŸŸã€‚å¦‚æœæœªè®¾ç½®ï¼Œé‚£ä¹ˆä¸ºç›‘æ§æ•´ä¸ªç½‘é¡µçš„å˜åŒ–
    translate.execute(); //æ‰§è¡Œç¿»è¯‘åˆå§‹åŒ–æ“ä½œï¼Œæ˜¾ç¤ºå‡ºselectè¯­è¨€é€‰æ‹©
  </script>
  <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.3.4/lib/darkmode-js.min.js"></script>
  <script>
    function addDarkmodeWidget() {
      new Darkmode().showWidget();
    }
    window.addEventListener('load', addDarkmodeWidget);
    const options = {
      bottom: '64px', // default: '32px'
      right: 'unset', // default: '32px'
      left: '32px', // default: 'unset'
      time: '0.5s', // default: '0.3s'
      mixColor: '#fff', // default: '#fff'
      backgroundColor: '#fff',  // default: '#fff'
      buttonColorDark: '#100f2c',  // default: '#100f2c'
      buttonColorLight: '#fff', // default: '#fff'
      saveInCookies: false, // default: true,
      label: 'ğŸŒ“', // default: ''
      autoMatchOsTheme: true // default: true
    }

    const darkmode = new Darkmode(options);
    darkmode.showWidget();
    
  </script>
</body>
</html>
